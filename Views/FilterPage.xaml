<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:Receptkonyv_MAUI"
             x:Class="Receptkonyv_MAUI.FilterPage"
             x:DataType="local:FilterPageViewModel"
             Title="Recipe Search"
             BackgroundColor="#F7F9FC">

    <Grid RowDefinitions="Auto, Auto, *" Padding="20" RowSpacing="15">

        <VerticalStackLayout Grid.Row="0" Spacing="10">
            <Label Text="ðŸ” Search Recipes" 
                   FontSize="24" 
                   FontAttributes="Bold" 
                   TextColor="#4527A0"/>

            <Border StrokeShape="RoundRectangle 12"
                    StrokeThickness="0"
                    BackgroundColor="White"
                    Padding="10,0"
                    HeightRequest="50">
                <Border.Shadow>
                    <Shadow Brush="Black" Offset="0,2" Radius="5" Opacity="0.05"/>
                </Border.Shadow>

                <Grid ColumnDefinitions="30, *">
                    <Label Grid.Column="0" Text="ðŸ”Ž" VerticalOptions="Center" HorizontalOptions="Center"/>
                    <Entry Grid.Column="1"
                           Placeholder="Enter ingredient..."
                           Text="{Binding FilterTerm}"
                           TextColor="#37474F"
                           FontSize="16"
                           VerticalOptions="Center"/>
                </Grid>
            </Border>
        </VerticalStackLayout>

        <Button Grid.Row="1"
                Text="Apply Filter"
                Command="{Binding ApplyFilterAsyncCommand}"
                TextColor="White"
                FontAttributes="Bold"
                CornerRadius="14"
                HeightRequest="50"
                FontSize="16">
            <Button.Shadow>
                <Shadow Brush="#5E35B1" Offset="0,4" Radius="8" Opacity="0.4"/>
            </Button.Shadow>
            <Button.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Color="#7E57C2" Offset="0.0" />
                    <GradientStop Color="#512DA8" Offset="1.0" />
                </LinearGradientBrush>
            </Button.Background>
        </Button>

        <CollectionView Grid.Row="2" 
                        ItemsSource="{Binding FilteredRecipes}"
                        Margin="0,10,0,0">

            <CollectionView.EmptyView>
                <VerticalStackLayout VerticalOptions="Center" HorizontalOptions="Center" Spacing="10">
                    <Label Text="ðŸ§" FontSize="50"/>
                    <Label Text="No recipes found." TextColor="#90A4AE" FontSize="16"/>
                </VerticalStackLayout>
            </CollectionView.EmptyView>

            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="local:Recipe">

                    <Border Margin="0,0,0,12"
                            Padding="0"
                            BackgroundColor="White"
                            StrokeShape="RoundRectangle 16"
                            StrokeThickness="0">

                        <Border.Shadow>
                            <Shadow Brush="#5E35B1" Offset="0,2" Radius="6" Opacity="0.1"/>
                        </Border.Shadow>

                        <Grid ColumnDefinitions="6, *">

                            <BoxView Grid.Column="0" Color="#673AB7"/>

                            <VerticalStackLayout Grid.Column="1" Padding="15, 12" Spacing="4">
                                <Label Text="{Binding Name}"
                                       FontAttributes="Bold"
                                       FontSize="18"
                                       TextColor="#311B92"/>

                                <HorizontalStackLayout Spacing="5">
                                    <Label Text="ðŸ›’" FontSize="12" VerticalOptions="Center"/>
                                    <Label Text="{Binding IngredientsString}"
                                           FontSize="13"
                                           TextColor="#78909C"
                                           LineBreakMode="TailTruncation"
                                           MaxLines="1"
                                           VerticalOptions="Center"/>
                                </HorizontalStackLayout>
                            </VerticalStackLayout>

                        </Grid>
                    </Border>

                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>

</ContentPage>